import{j as e}from"./three-vendor-B3gp6cmk.js";import{r,L as a,d as s}from"./react-vendor-takh9Jyk.js";import{B as t,h as i,i as l,d as n,j as c,M as d,k as o,l as x,m as g,n as m,o as p,r as h,p as y,P as u,H as j,q as b,s as v,t as k}from"./index-CCYBg9KT.js";import{u as f,d as N}from"./redux-vendor-D_jwlZfB.js";import{P as w}from"./ProductGrid-D8duGOTz.js";import{I as C}from"./Input-BJqj1Wnk.js";import{A as P,m as S,z as F}from"./ui-vendor-CWlZ5n2I.js";import"./web3-vendor-OVZtbIUx.js";import"./ProductCard-3rI5Km4y.js";const A=({filters:a,onFilterChange:s,onClearFilters:l,categories:n=[]})=>{const[c,d]=r.useState(!1),[o,x]=r.useState({category:"",minPrice:"",maxPrice:"",rating:0,brands:[],inStock:!1,onSale:!1,...a}),[g,m]=r.useState({category:!0,price:!0,rating:!0,brands:!1,other:!1}),p=["Nike","Adidas","Puma","Apple","Samsung","Sony","LG","Dell"],h=e=>{m(r=>({...r,[e]:!r[e]}))},y=(e,r)=>{const a=""===r?"":parseFloat(r);x(r=>({...r,[e]:a}))},u=e=>{x(r=>{const a=r.brands.includes(e)?r.brands.filter(r=>r!==e):[...r.brands,e];return{...r,brands:a}})},j=()=>{s(o),d(!1)},b=()=>{x({category:"",minPrice:"",maxPrice:"",rating:0,brands:[],inStock:!1,onSale:!1}),l()},v=Object.values(o).filter(e=>Array.isArray(e)?e.length>0:"boolean"==typeof e?e:""!==e&&0!==e).length;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:hidden mb-4",children:e.jsxs(t,{variant:"outline",fullWidth:!0,icon:i,onClick:()=>d(!0),children:["Filters ",v>0&&`(${v})`]})}),e.jsx(P,{children:c&&e.jsxs(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>d(!1)}),e.jsx(S.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"tween"},className:"absolute inset-y-0 left-0 w-80 bg-white dark:bg-gray-900 overflow-y-auto",children:e.jsx($,{localFilters:o,setLocalFilters:x,expandedSections:g,toggleSection:h,categories:n,popularBrands:p,handlePriceChange:y,handleBrandToggle:u,handleApplyFilters:j,handleClearAll:b,activeFilterCount:v,onClose:()=>d(!1),isMobile:!0})})]})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx($,{localFilters:o,setLocalFilters:x,expandedSections:g,toggleSection:h,categories:n,popularBrands:p,handlePriceChange:y,handleBrandToggle:u,handleApplyFilters:j,handleClearAll:b,activeFilterCount:v})})]})},$=({localFilters:r,setLocalFilters:a,expandedSections:s,toggleSection:c,categories:d,popularBrands:o,handlePriceChange:x,handleBrandToggle:g,handleApplyFilters:m,handleClearAll:p,activeFilterCount:h,onClose:y,isMobile:u})=>e.jsxs("div",{className:(u?"p-6":"card p-6")+" space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(i,{}),"Filters ",h>0&&`(${h})`]}),u&&e.jsx("button",{onClick:y,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(l,{className:"w-5 h-5"})})]}),e.jsx(_,{title:"Category",isExpanded:s.category,onToggle:()=>c("category"),children:e.jsxs("select",{value:r.category,onChange:e=>a({...r,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Categories"}),d.map(r=>e.jsx("option",{value:r._id,children:r.name},r._id))]})}),e.jsx(_,{title:"Price Range",isExpanded:s.price,onToggle:()=>c("price"),children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(C,{type:"number",placeholder:"Min Price",value:r.minPrice,onChange:e=>x("minPrice",e.target.value),min:"0"}),e.jsx(C,{type:"number",placeholder:"Max Price",value:r.maxPrice,onChange:e=>x("maxPrice",e.target.value),min:"0"})]})}),e.jsx(_,{title:"Rating",isExpanded:s.rating,onToggle:()=>c("rating"),children:e.jsx("div",{className:"space-y-2",children:[4,3,2,1].map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 p-2 rounded-lg",children:[e.jsx("input",{type:"radio",name:"rating",checked:r.rating===s,onChange:()=>a({...r,rating:s}),className:"text-primary-600 focus:ring-primary-500"}),e.jsxs("div",{className:"flex items-center gap-1",children:[[...Array(5)].map((r,a)=>e.jsx(n,{className:"w-4 h-4 "+(a<s?"text-yellow-400 fill-current":"text-gray-300 dark:text-gray-600")},a)),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-1",children:"& Up"})]})]},s))})}),e.jsx(_,{title:"Brands",isExpanded:s.brands,onToggle:()=>c("brands"),children:e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:o.map(a=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 p-2 rounded-lg",children:[e.jsx("input",{type:"checkbox",checked:r.brands.includes(a),onChange:()=>g(a),className:"rounded text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:a})]},a))})}),e.jsx(_,{title:"Other",isExpanded:s.other,onToggle:()=>c("other"),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 p-2 rounded-lg",children:[e.jsx("input",{type:"checkbox",checked:r.inStock,onChange:e=>a({...r,inStock:e.target.checked}),className:"rounded text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"In Stock Only"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 p-2 rounded-lg",children:[e.jsx("input",{type:"checkbox",checked:r.onSale,onChange:e=>a({...r,onSale:e.target.checked}),className:"rounded text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"On Sale"})]})]})}),e.jsxs("div",{className:"space-y-2 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(t,{variant:"primary",fullWidth:!0,onClick:m,children:"Apply Filters"}),e.jsx(t,{variant:"outline",fullWidth:!0,onClick:p,children:"Clear All"})]})]}),_=({title:r,isExpanded:a,onToggle:s,children:t})=>e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-4",children:[e.jsxs("button",{onClick:s,className:"flex items-center justify-between w-full text-left font-semibold text-gray-900 dark:text-white mb-3 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:[r,e.jsx(S.div,{animate:{rotate:a?180:0},children:e.jsx(c,{})})]}),e.jsx(P,{children:a&&e.jsx(S.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:t})})]}),M=({product:s,isOpen:i,onClose:l})=>{var c,u,j,b,v,k,w;const C=f(),{items:P}=N(e=>e.wishlist),[A,$]=r.useState(0),[_,M]=r.useState({}),[B,T]=r.useState(1);if(!s)return null;const E=P.some(e=>e._id===s._id),L=s.discount||(s.originalPrice&&s.price?Math.round((s.originalPrice-s.price)/s.originalPrice*100):0);return e.jsx(d,{isOpen:i,onClose:l,size:"xl",title:"Quick View",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"aspect-square bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden",children:e.jsx("img",{src:(null==(u=null==(c=s.images)?void 0:c[A])?void 0:u.url)||"/placeholder-product.jpg",alt:s.name,className:"w-full h-full object-cover"})}),(null==(j=s.images)?void 0:j.length)>1&&e.jsx("div",{className:"grid grid-cols-4 gap-2",children:s.images.map((r,a)=>e.jsx(S.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>$(a),className:"aspect-square rounded-lg overflow-hidden border-2 transition-colors "+(A===a?"border-primary-500":"border-transparent hover:border-gray-300 dark:hover:border-gray-600"),children:e.jsx("img",{src:r.url,alt:`${s.name} ${a+1}`,className:"w-full h-full object-cover"})},a))})]}),e.jsxs("div",{className:"space-y-6",children:[(null==(b=s.category)?void 0:b.name)&&e.jsx("p",{className:"text-sm text-primary-600 dark:text-primary-400 font-medium uppercase tracking-wide",children:s.category.name}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((r,a)=>e.jsx(n,{className:"w-5 h-5 "+(a<Math.floor(s.ratings||0)?"text-yellow-400 fill-current":"text-gray-300 dark:text-gray-600")},a))}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[null==(v=s.ratings)?void 0:v.toFixed(1)," (",s.numOfReviews||0," reviews)"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-4xl font-bold text-primary-600 dark:text-primary-400",children:["$",null==(k=s.price)?void 0:k.toFixed(2)]}),s.originalPrice&&s.originalPrice>s.price&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xl text-gray-400 line-through",children:["$",s.originalPrice.toFixed(2)]}),e.jsxs("span",{className:"bg-red-500 text-white px-2 py-1 rounded-full text-sm font-bold",children:[L,"% OFF"]})]})]}),s.description&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 line-clamp-3",children:s.description}),null==(w=s.variants)?void 0:w.map(r=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[r.type,": ",_[r.type]||"Select"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.options.map(a=>e.jsx(S.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{return e=r.type,s=a,void M(r=>({...r,[e]:s}));var e,s},className:"px-4 py-2 rounded-lg border-2 transition-colors "+(_[r.type]===a?"border-primary-500 bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"),children:a},a))})]},r.type)),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Quantity"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{B>1&&T(e=>e-1)},disabled:B<=1,className:"w-10 h-10 flex items-center justify-center rounded-lg border-2 border-gray-300 dark:border-gray-600 hover:border-primary-500 dark:hover:border-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"-"}),e.jsx("span",{className:"text-xl font-semibold text-gray-900 dark:text-white w-12 text-center",children:B}),e.jsx("button",{onClick:()=>{B<s.stock&&T(e=>e+1)},disabled:B>=s.stock,className:"w-10 h-10 flex items-center justify-center rounded-lg border-2 border-gray-300 dark:border-gray-600 hover:border-primary-500 dark:hover:border-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"+"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["(",s.stock," available)"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(t,{variant:"primary",fullWidth:!0,icon:o,onClick:()=>{var e,r;C(p({product:s._id,name:s.name,price:s.price,image:null==(r=null==(e=s.images)?void 0:e[0])?void 0:r.url,stock:s.stock,quantity:B,variants:_})),F.success("Added to cart"),l()},disabled:0===s.stock,children:"Add to Cart"}),e.jsx(t,{variant:E?"danger":"outline",icon:x,onClick:()=>{E?(C(h(s._id)),F.success("Removed from wishlist")):(C(y(s)),F.success("Added to wishlist"))},children:E?"Remove":"Wishlist"})]}),e.jsx(a,{to:`/products/${s._id}`,children:e.jsx(t,{variant:"ghost",fullWidth:!0,onClick:l,children:"View Full Details →"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(g,{className:"w-5 h-5 text-primary-600"}),e.jsx("span",{children:"Free Shipping"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(m,{className:"w-5 h-5 text-primary-600"}),e.jsx("span",{children:"Secure Payment"})]})]})]})]})})},B=()=>{const a=f(),[i,n]=s(),{products:c,loading:d,error:o,totalProducts:x,currentPage:g,totalPages:m}=N(e=>e.products),[p,h]=r.useState(null),[y,C]=r.useState("grid"),[F,$]=r.useState({category:i.get("category")||"",minPrice:i.get("minPrice")||"",maxPrice:i.get("maxPrice")||"",rating:parseInt(i.get("rating"))||0,brands:(null==(_=i.get("brands"))?void 0:_.split(",").filter(Boolean))||[],inStock:"true"===i.get("inStock"),onSale:"true"===i.get("onSale"),page:parseInt(i.get("page"))||1,sort:i.get("sort")||"",search:i.get("search")||""});var _;const B=e=>{const r=new URLSearchParams;Object.entries(e).forEach(([e,a])=>{a&&0!==a&&(!Array.isArray(a)||a.length>0)&&r.set(e,Array.isArray(a)?a.join(","):a)}),n(r)};r.useEffect(()=>{(async()=>{try{await a(k({...F,limit:12})).unwrap()}catch(e){}})()},[a,F]);const T=()=>{$({category:"",minPrice:"",maxPrice:"",rating:0,brands:[],inStock:!1,onSale:!1,page:1,sort:"",search:""}),B({})},E=e=>{const r={...F,page:e};$(r),B(r),window.scrollTo({top:0,behavior:"smooth"})},L=[];F.category&&L.push({key:"category",label:"Category",value:F.category}),F.minPrice&&L.push({key:"minPrice",label:"Min Price",value:`$${F.minPrice}`}),F.maxPrice&&L.push({key:"maxPrice",label:"Max Price",value:`$${F.maxPrice}`}),F.rating&&L.push({key:"rating",label:"Rating",value:`${F.rating}+ ⭐`}),F.brands.length>0&&F.brands.forEach(e=>{L.push({key:"brands",label:"Brand",value:e})}),F.inStock&&L.push({key:"inStock",label:"In Stock",value:"Yes"}),F.onSale&&L.push({key:"onSale",label:"On Sale",value:"Yes"});return d&&1===F.page?e.jsx(u,{text:"Loading products..."}):e.jsxs(e.Fragment,{children:[e.jsx(j,{children:e.jsx("title",{children:"Products - NexusMart"})}),e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(S.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"All Products"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Discover ",x||0," amazing products"]})]}),e.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(A,{filters:F,onFilterChange:e=>{const r={...e,page:1};$(r),B(r)},onClearFilters:T,categories:[{_id:"electronics",name:"Electronics"},{_id:"fashion",name:"Fashion"},{_id:"home",name:"Home & Living"},{_id:"sports",name:"Sports"},{_id:"books",name:"Books"}]})}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"card p-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-gray-600 dark:text-gray-400",children:["Showing ",e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[12*(g-1)+1,"-",Math.min(12*g,x||0)]})," of ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:x||0})," results"]}),e.jsxs("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[e.jsxs("select",{value:F.sort,onChange:e=>{const r={...F,sort:e.target.value,page:1};$(r),B(r)},className:"flex-1 sm:flex-none px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Sort by: Best Match"}),e.jsx("option",{value:"price_asc",children:"Price: Low to High"}),e.jsx("option",{value:"price_desc",children:"Price: High to Low"}),e.jsx("option",{value:"rating_desc",children:"Highest Rated"}),e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"popular",children:"Most Popular"})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 border border-gray-300 dark:border-gray-600 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>C("grid"),className:"p-2 rounded "+("grid"===y?"bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"),children:e.jsx(b,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>C("list"),className:"p-2 rounded "+("list"===y?"bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"),children:e.jsx(v,{className:"w-5 h-5"})})]})]})]}),L.length>0&&e.jsxs(S.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Active Filters:"}),e.jsx(P,{children:L.map((r,a)=>e.jsxs(S.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"inline-flex items-center gap-1 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 px-3 py-1 rounded-full text-sm",children:[e.jsxs("span",{className:"font-medium",children:[r.label,":"]}),e.jsx("span",{children:r.value}),e.jsx("button",{onClick:()=>((e,r)=>{let a={...F};"brands"===e?a.brands=F.brands.filter(e=>e!==r):a[e]="inStock"!==e&&"onSale"!==e&&("rating"===e?0:""),a.page=1,$(a),B(a)})(r.key,r.value),className:"ml-1 hover:bg-primary-200 dark:hover:bg-primary-800/50 rounded-full p-0.5",children:e.jsx(l,{className:"w-3 h-3"})})]},`${r.key}-${r.value}-${a}`))}),e.jsx(t,{variant:"ghost",size:"sm",onClick:T,children:"Clear All"})]}),o?e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx("div",{className:"text-red-500 text-xl mb-4",children:"⚠️"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Error Loading Products"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:o}),e.jsx(t,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]}):e.jsx(w,{products:c||[],loading:d,onQuickView:e=>{h(e)}}),!d&&m>1&&e.jsxs(S.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-center items-center gap-2 mt-8",children:[e.jsx(t,{variant:"outline",onClick:()=>E(g-1),disabled:1===g,children:"Previous"}),e.jsx("div",{className:"flex gap-2",children:Array.from({length:Math.min(5,m)},(r,a)=>{let s;return s=m<=5||g<=3?a+1:g>=m-2?m-4+a:g-2+a,e.jsx(t,{variant:g===s?"primary":"outline",onClick:()=>E(s),children:s},s)})}),e.jsx(t,{variant:"outline",onClick:()=>E(g+1),disabled:g===m,children:"Next"})]})]})]})]}),e.jsx(M,{product:p,isOpen:!!p,onClose:()=>h(null)})]})]})};export{B as default};
