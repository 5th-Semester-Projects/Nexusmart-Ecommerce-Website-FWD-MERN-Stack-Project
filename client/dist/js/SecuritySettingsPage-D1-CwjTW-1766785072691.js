import{j as e}from"./three-vendor-q47B8kY1-1766785072691.js";import{r as t}from"./react-vendor-Jz9jFFXE-1766785072691.js";import{n as s,ay as a,a1 as i,Z as n,aJ as r,b6 as l,d as c,a_ as o,aL as d,T as x,r as m,b7 as h,s as u,b8 as p,aC as g,b9 as j,H as f,aK as y}from"./index-BKQ_WQ_I-1766785072691.js";import{z as b,m as w,A as v}from"./ui-vendor-h53B6cZa-1766785072691.js";import{Q as N}from"./index-tV9hn8EH-1766785072691.js";import"./redux-vendor-M2AfqdKk-1766785072691.js";const S=({length:s=6,value:a,onChange:i})=>{const n=t.useRef([]),r=e=>{var t;e.preventDefault();const a=e.clipboardData.getData("text").slice(0,s);/^\d+$/.test(a)&&(i(a.padEnd(s,"")),null==(t=n.current[Math.min(a.length,s-1)])||t.focus())};return e.jsx("div",{className:"flex gap-3 justify-center",children:Array.from({length:s}).map((t,l)=>e.jsx("input",{ref:e=>n.current[l]=e,type:"text",maxLength:1,value:a[l]||"",onChange:e=>((e,t)=>{var r;if(!/^\d*$/.test(t))return;const l=a.split("");l[e]=t,i(l.join("")),t&&e<s-1&&(null==(r=n.current[e+1])||r.focus())})(l,e.target.value),onKeyDown:e=>((e,t)=>{var s;"Backspace"===t.key&&!a[e]&&e>0&&(null==(s=n.current[e-1])||s.focus())})(l,e),onPaste:r,className:"w-12 h-14 text-center text-2xl font-bold bg-white/5 border border-white/10 rounded-xl text-white focus:border-cyan-500 focus:ring-1 focus:ring-cyan-500 outline-none transition-all"},l))})},k=({step:t,currentStep:s,title:a,description:i,children:r})=>{const l=t===s,c=t<s;return e.jsxs("div",{className:"relative pl-10 pb-8 "+(3===t?"":"border-l-2 border-white/10 ml-4"),children:[e.jsx("div",{className:"absolute -left-4 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold "+(c?"bg-green-600 text-white":l?"bg-gradient-to-r from-purple-600 to-cyan-600 text-white":"bg-white/10 text-gray-400"),children:c?e.jsx(n,{}):t}),e.jsxs("div",{className:""+(l?"opacity-100":"opacity-50"),children:[e.jsx("h3",{className:"font-bold text-white text-lg mb-1",children:a}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:i}),l&&r]})]})},A=({onComplete:o})=>{const[d,x]=t.useState(1),[m,h]=t.useState("app"),[u,p]=t.useState(""),[g,j]=t.useState(""),[f,y]=t.useState(""),[w,v]=t.useState([]),[A,C]=t.useState(!1),[D,M]=t.useState(!1);return e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-r from-purple-600 to-cyan-600 flex items-center justify-center",children:e.jsx(s,{className:"text-3xl text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Setup Two-Factor Authentication"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Add an extra layer of security to your account"})]}),e.jsxs(k,{step:1,currentStep:d,title:"Choose Verification Method",description:"Select how you want to receive verification codes",children:[e.jsx("div",{className:"space-y-3 mb-4",children:[{id:"app",icon:a,label:"Authenticator App",desc:"Use Google Authenticator, Authy, or similar"},{id:"sms",icon:a,label:"SMS",desc:"Receive codes via text message"},{id:"email",icon:i,label:"Email",desc:"Receive codes via email"}].map(t=>e.jsxs("button",{onClick:()=>h(t.id),className:"w-full flex items-center gap-4 p-4 rounded-xl border transition-all "+(m===t.id?"bg-gradient-to-r from-purple-600/20 to-cyan-600/20 border-cyan-500":"bg-white/5 border-white/10 hover:border-white/20"),children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center "+(m===t.id?"bg-cyan-600":"bg-white/10"),children:e.jsx(t.icon,{className:"text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-white",children:t.label}),e.jsx("p",{className:"text-sm text-gray-400",children:t.desc})]}),m===t.id&&e.jsx(n,{className:"ml-auto text-cyan-400"})]},t.id))}),e.jsx("button",{onClick:async()=>{C(!0);try{const{data:e}=await c.post("/auth/2fa/setup",{method:m});p(e.secret),j(e.qrUrl),x(2)}catch(e){b.error("Failed to initialize 2FA setup")}finally{C(!1)}},disabled:A,className:"w-full py-3 bg-gradient-to-r from-purple-600 to-cyan-600 text-white rounded-xl font-medium disabled:opacity-50 flex items-center justify-center gap-2",children:A?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):"Continue"})]}),e.jsxs(k,{step:2,currentStep:d,title:"app"===m?"Scan QR Code":"Enter Verification Code",description:"app"===m?"Scan this QR code with your authenticator app":"Enter the code sent to your device",children:["app"===m&&e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-2xl w-fit mx-auto mb-4",children:e.jsx(N,{value:g||"otpauth://totp/NexusMart:demo@example.com?secret=DEMO&issuer=NexusMart",size:180})}),e.jsxs("div",{className:"bg-white/5 rounded-xl p-4",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Can't scan? Enter this code manually:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 px-3 py-2 bg-black/30 rounded-lg font-mono text-cyan-400 text-sm",children:u||"DEMO-SECRET-KEY"}),e.jsx("button",{onClick:async()=>{await navigator.clipboard.writeText(u),M(!0),b.success("Secret key copied!"),setTimeout(()=>M(!1),2e3)},className:"p-2 rounded-lg transition-colors "+(D?"bg-green-600 text-white":"bg-white/10 text-gray-400 hover:text-white"),children:D?e.jsx(n,{}):e.jsx(r,{})})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Enter 6-digit verification code"}),e.jsx(S,{length:6,value:f,onChange:y})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>x(1),className:"px-6 py-3 bg-white/10 text-white rounded-xl font-medium",children:"Back"}),e.jsx("button",{onClick:async()=>{if(6===f.length){C(!0);try{const{data:e}=await c.post("/auth/2fa/verify",{code:f,method:m});v(e.backupCodes),x(3)}catch(e){b.error("Invalid verification code")}finally{C(!1)}}else b.error("Please enter a valid 6-digit code")},disabled:A||6!==f.length,className:"flex-1 py-3 bg-gradient-to-r from-purple-600 to-cyan-600 text-white rounded-xl font-medium disabled:opacity-50 flex items-center justify-center gap-2",children:A?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):"Verify"})]})]}),e.jsxs(k,{step:3,currentStep:d,title:"Save Backup Codes",description:"Store these codes safely. You can use them if you lose access to your device.",children:[e.jsx("div",{className:"bg-gradient-to-br from-yellow-900/30 to-orange-900/30 border border-yellow-500/30 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(l,{className:"text-yellow-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-400",children:"Important!"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Each backup code can only be used once. Keep them in a secure place."})]})]})}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-6",children:(w.length>0?w:["ABCD-1234","EFGH-5678","IJKL-9012","MNOP-3456","QRST-7890","UVWX-1234","YZAB-5678","CDEF-9012"]).map((t,s)=>e.jsx("div",{className:"px-4 py-2 bg-white/5 rounded-lg font-mono text-white text-center",children:t},s))}),e.jsxs("button",{onClick:()=>{b.success("Two-factor authentication enabled!"),null==o||o()},className:"w-full py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-xl font-medium flex items-center justify-center gap-2",children:[e.jsx(n,{}),"I've Saved My Backup Codes"]})]})]})},C=e=>{const t=new Date(e),s=new Date-t,a=Math.floor(s/6e4),i=Math.floor(s/36e5),n=Math.floor(s/864e5);return a<1?"Just now":a<60?`${a} min ago`:i<24?`${i} hours ago`:n<7?`${n} days ago`:t.toLocaleDateString("en-PK",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},D=({session:s,isCurrentSession:i,onRevoke:n})=>{const[r,c]=t.useState(!1),o=(u=s.deviceType,{desktop:g,mobile:a,tablet:p}[u]||j);var u;const f=(y=s.userAgent).includes("Chrome")?{name:"Chrome",color:"text-yellow-400"}:y.includes("Firefox")?{name:"Firefox",color:"text-orange-400"}:y.includes("Safari")?{name:"Safari",color:"text-blue-400"}:y.includes("Edge")?{name:"Edge",color:"text-cyan-400"}:{name:"Unknown",color:"text-gray-400"};var y;return e.jsxs(w.div,{layout:!0,className:"rounded-2xl border overflow-hidden "+(i?"bg-gradient-to-r from-green-900/30 to-emerald-900/30 border-green-500/30":s.suspicious?"bg-gradient-to-r from-red-900/30 to-orange-900/30 border-red-500/30":"bg-white/5 border-white/10"),children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center "+(i?"bg-green-500/20":s.suspicious?"bg-red-500/20":"bg-white/10"),children:e.jsx(o,{className:"text-xl "+(i?"text-green-400":s.suspicious?"text-red-400":"text-gray-400")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-medium ${f.color}`,children:f.name}),e.jsx("span",{className:"text-gray-400",children:"on"}),e.jsx("span",{className:"text-white font-medium",children:s.os||"Unknown OS"}),i&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-500/20 text-green-400 rounded-full",children:"Current Session"}),s.suspicious&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-red-500/20 text-red-400 rounded-full flex items-center gap-1",children:[e.jsx(l,{className:"text-xs"}),"Suspicious"]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(d,{className:"text-xs"}),s.location||"Unknown Location"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(x,{className:"text-xs"}),C(s.lastActive)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c(!r),className:"p-2 text-gray-400 hover:text-white transition-colors",children:e.jsx(m,{className:"transition-transform "+(r?"rotate-180":"")})}),!i&&e.jsx("button",{onClick:()=>null==n?void 0:n(s.id),className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"End this session",children:e.jsx(h,{})})]})]})}),e.jsx(v,{children:r&&e.jsx(w.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-white/10 overflow-hidden",children:e.jsxs("div",{className:"p-4 space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"IP Address"}),e.jsx("span",{className:"text-white font-mono",children:s.ip||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Login Time"}),e.jsx("span",{className:"text-white",children:C(s.createdAt)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Last Active"}),e.jsx("span",{className:"text-white",children:C(s.lastActive)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Device"}),e.jsx("span",{className:"text-white",children:s.device||"Unknown Device"})]}),s.loginMethod&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Login Method"}),e.jsx("span",{className:"text-white capitalize",children:s.loginMethod})]})]})})})]})},M=({entry:t})=>{const s="success"===t.status;return e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-xl "+(s?"bg-white/5":"bg-red-900/20 border border-red-500/30"),children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center "+(s?"bg-green-500/20":"bg-red-500/20"),children:s?e.jsx(n,{className:"text-green-400"}):e.jsx(u,{className:"text-red-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white font-medium",children:s?"Successful Login":"Failed Login Attempt"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400 mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(d,{className:"text-xs"}),t.location||"Unknown"]}),e.jsx("span",{children:t.ip})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-400",children:C(t.timestamp)}),t.method&&e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:t.method})]})]})},E=()=>{const[a,i]=t.useState("sessions"),[n,r]=t.useState([]),[d,x]=t.useState([]),[m,h]=t.useState(!0),[u,p]=t.useState(null);t.useEffect(()=>{g()},[]);const g=async()=>{try{h(!0),r([{id:"1",deviceType:"desktop",os:"Windows 11",userAgent:"Chrome/120.0",location:"Lahore, Pakistan",ip:"39.45.xxx.xxx",createdAt:new Date,lastActive:new Date,device:"Dell XPS 15",loginMethod:"password"},{id:"2",deviceType:"mobile",os:"iOS 17",userAgent:"Safari/605.1",location:"Karachi, Pakistan",ip:"182.188.xxx.xxx",createdAt:new Date(Date.now()-1728e5),lastActive:new Date(Date.now()-216e5),device:"iPhone 15 Pro",loginMethod:"google"},{id:"3",deviceType:"desktop",os:"macOS Sonoma",userAgent:"Firefox/121.0",location:"New York, USA",ip:"192.168.xxx.xxx",createdAt:new Date(Date.now()-432e6),lastActive:new Date(Date.now()-432e6),device:"MacBook Pro",loginMethod:"password",suspicious:!0}]),p("1"),x([{id:"1",status:"success",location:"Lahore, Pakistan",ip:"39.45.xxx.xxx",timestamp:new Date,method:"password"},{id:"2",status:"success",location:"Karachi, Pakistan",ip:"182.188.xxx.xxx",timestamp:new Date(Date.now()-1728e5),method:"google"},{id:"3",status:"failed",location:"Unknown",ip:"103.xxx.xxx.xxx",timestamp:new Date(Date.now()-2592e5),method:"password"},{id:"4",status:"failed",location:"Unknown",ip:"103.xxx.xxx.xxx",timestamp:new Date(Date.now()-2592e5),method:"password"},{id:"5",status:"success",location:"New York, USA",ip:"192.168.xxx.xxx",timestamp:new Date(Date.now()-432e6),method:"password"}])}finally{h(!1)}},j=async e=>{try{await c.delete(`/auth/sessions/${e}`),r(t=>t.filter(t=>t.id!==e)),b.success("Session ended successfully")}catch(t){b.error("Failed to end session")}},f=n.filter(e=>e.suspicious).length,y=d.filter(e=>"failed"===e.status).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(s,{className:"text-cyan-400"}),"Security & Login History"]}),e.jsxs("p",{className:"text-gray-400 mt-1",children:[n.length," active sessions â€¢ ",y," failed attempts"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:g,className:"p-3 bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white rounded-xl transition-colors",children:e.jsx(o,{})}),e.jsx("button",{onClick:async()=>{if(confirm("Are you sure you want to end all other sessions?"))try{await c.delete("/auth/sessions/all"),r(e=>e.filter(e=>e.id===u)),b.success("All other sessions ended")}catch(e){b.error("Failed to end sessions")}},className:"px-4 py-2 bg-red-600/20 text-red-400 hover:bg-red-600/30 rounded-xl font-medium transition-colors",children:"End All Other Sessions"})]})]}),f>0&&e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gradient-to-r from-red-900/30 to-orange-900/30 border border-red-500/30 rounded-2xl",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-500/20 flex items-center justify-center",children:e.jsx(l,{className:"text-2xl text-red-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-red-400",children:"Suspicious Activity Detected"}),e.jsxs("p",{className:"text-sm text-gray-300",children:[f," suspicious session(s) found. Review and revoke if you don't recognize them."]})]})]}),e.jsx("div",{className:"flex gap-2 bg-white/5 rounded-xl p-1 w-fit",children:[{key:"sessions",label:"Active Sessions",count:n.length},{key:"history",label:"Login History",count:d.length}].map(t=>e.jsxs("button",{onClick:()=>i(t.key),className:"px-6 py-2 rounded-lg font-medium transition-colors "+(a===t.key?"bg-gradient-to-r from-purple-600 to-cyan-600 text-white":"text-gray-400 hover:text-white"),children:[t.label," (",t.count,")"]},t.key))}),m?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>e.jsx("div",{className:"h-24 bg-white/5 rounded-2xl animate-pulse"},t))}):"sessions"===a?e.jsx("div",{className:"space-y-4",children:n.map(t=>e.jsx(D,{session:t,isCurrentSession:t.id===u,onRevoke:j},t.id))}):e.jsx("div",{className:"space-y-3",children:d.map(t=>e.jsx(M,{entry:t},t.id))})]})},F=()=>{const[i,n]=t.useState("2fa"),r=[{id:"2fa",label:"Two-Factor Auth",icon:a},{id:"sessions",label:"Active Sessions",icon:g},{id:"history",label:"Login History",icon:y}];return e.jsxs(e.Fragment,{children:[e.jsxs(f,{children:[e.jsx("title",{children:"Security Settings - NexusMart"}),e.jsx("meta",{name:"description",content:"Manage your account security settings"})]}),e.jsxs("div",{className:"min-h-screen relative py-12",children:[e.jsx("div",{className:"fixed inset-0 overflow-hidden -z-10 bg-gradient-to-br from-purple-950 via-gray-950 to-purple-950/50"}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(w.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 \r\n                          bg-gradient-to-br from-purple-600 to-blue-600 rounded-2xl mb-6",children:e.jsx(s,{className:"text-4xl text-white"})}),e.jsx("h1",{className:"text-4xl font-bold gradient-text mb-4",style:{fontFamily:"Orbitron, sans-serif"},children:"Security Settings"}),e.jsx("p",{className:"text-purple-300/70 text-lg",children:"Protect your account with advanced security features"})]}),e.jsxs("div",{className:"grid lg:grid-cols-4 gap-8",children:[e.jsx(w.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"lg:col-span-1",children:e.jsxs("div",{className:"glass-card rounded-2xl p-4 sticky top-24",children:[e.jsx("nav",{className:"space-y-2",children:r.map(t=>e.jsxs("button",{onClick:()=>n(t.id),className:"w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all "+(i===t.id?"bg-gradient-to-r from-purple-600/30 to-blue-600/30 text-cyan-400 border border-cyan-500/30":"text-purple-300 hover:bg-purple-500/10"),children:[e.jsx(t.icon,{className:"text-xl"}),e.jsx("span",{className:"font-medium",children:t.label})]},t.id))}),e.jsx("div",{className:"mt-6 p-4 bg-yellow-500/10 border border-yellow-500/30 rounded-xl",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(l,{className:"text-yellow-400 text-xl flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-yellow-400 font-semibold text-sm mb-1",children:"Security Tip"}),e.jsx("p",{className:"text-yellow-300/70 text-xs",children:"Enable 2FA to add an extra layer of protection to your account."})]})]})})]})}),e.jsxs(w.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"lg:col-span-3",children:["2fa"===i&&e.jsx(A,{}),"sessions"===i&&e.jsx(E,{showOnlyActive:!0}),"history"===i&&e.jsx(E,{})]})]})]})]})]})};export{F as default};
